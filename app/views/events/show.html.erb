<%# cloudinary for images %>
<div class="event-banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/breakfast.jpg)">
  <div class="container d-flex flex-column justify-content-center h-100">
    <h1><%= @event.title %></h1>
    <h3><%= @event.category.name %></h3>
    <%= link_to 'Attend', event_participations_path(@event), method: 'post', class: "btn btn-primary px-4 rounded-5", style:"max-width: max-content;" %>
  </div>
</div>

<div class='container'>
<div class="row position-relative">
  <div class="event-popup-title col-sm-6 mx-2 pt-2 text-center">
    <h3><%= @event.date %></h3>
  </div>
  <div class="col-sm-6 pt-5 bg-white">
    <div class='relative-position-right'>
      <%= link_to 'Back to events', events_path, class: "btn btn-primary"%>

      <% if @event.user == current_user %>
        <%= link_to "edit", edit_event_path(@event), class: "btn btn-primary" %>
      <% end %>
      <%# needs to set the path for both buttons,
      \ Join button need to be disabled if user joined the event.
      \ Also need a pop-up to let know the user he joined the event.  %>

      <%# Jose added the button below to delete the event.
      It only appers if the user is the one who created the event%>

      <% if @event.user == current_user %>
        <%= link_to "Delete", event_path(@event),
        data: { confirm: "Are you sure you want to delete this event?" },
        method: :delete,
        class: 'ms-3 btn btn-primary',
        style: "min-width: 100px;" %>
      <% end %>

      <% if @my_participation %>
        <%= link_to "Bail on Event", participation_path(@my_participation),
        data: { confirm: "Are you sure you want to delete this event?" },
        method: "delete",
        class: 'ms-3 btn btn-danger',
        style: "min-width: 100px;" %>
      <% end %>
    </div>
    <h4>Location:</h4>
    <p><%= @event.location %></p>
    <h4>Description:</h4>
    <p><%= @event.description %></p>

  </div>

  <div class="col-sm-6 bg-white min-height: 380px">
    <div class="map-event"
      data-controller="mapbox"
      data-mapbox-markers-value="<%= @markers.to_json %>"
      data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>

</div>
</div>
