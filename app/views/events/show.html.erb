<%# cloudinary for images %>
<div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/breakfast.jpg)">
<h2>Event Details</h2>
</div>

<div class='container'>
<div class="row" class="d-flex justify-content-between">

  <div class="details-event, col-sm-6 pt-5">
    <h4><%= @event.title %></h4>
    <p><%= @event.date %></p>
    <p><%= @event.location %></p>
    <p><%= @event.description %></p>

    <%= link_to 'Back to events', events_path, class: "btn btn-primary"%>

    <%= link_to 'Join', event_participations_path(@event), method: 'post', class: "btn btn-primary" %>

    <% if @event.user == current_user %>
      <%= link_to "edit", edit_event_path(@event), class: "btn btn-primary" %>
    <% end %>
    <%# needs to set the path for both buttons,
    \ Join button need to be disabled if user joined the event.
    \ Also need a pop-up to let know the user he joined the event.  %>

    <%# Jose added the button bellow to delete the event.
    It only appers if the user is the one who created the event%>

    <% if @event.user == current_user %>
      <%= link_to "Delete", event_path(@event),
      data: { confirm: "Are you sure you want to delete this event?" },
      method: :delete,
      class: 'ms-3 btn btn-primary',
      style: "min-width: 100px;" %>
    <% end %>

    <% if @my_participation %>
      <%= link_to "Bail on Event", participation_path(@my_participation),
      data: { confirm: "Are you sure you want to delete this event?" },
      method: "delete",
      class: 'ms-3 btn btn-danger',
      style: "min-width: 100px;" %>
    <% end %>
  </div>

  <div class="col-sm-6 p-4">
    <div id="map"
      data-controller="mapbox"
      data-mapbox-markers-value="<%= @markers.to_json %>"
      data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>

</div>
</div>
